"use strict";(self.webpackChunkmd_note=self.webpackChunkmd_note||[]).push([[6813],{5686:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>a});var s=i(5893),t=i(1151);const r={},o="03 AWS Lambda Functions",c={id:"AWS/Certificates/SolutionArchitecture/03LambdaFunctions",title:"03 AWS Lambda Functions",description:"Introduce to Serverless",source:"@site/docs/AWS/Certificates/SolutionArchitecture/03LambdaFunctions.md",sourceDirName:"AWS/Certificates/SolutionArchitecture",slug:"/AWS/Certificates/SolutionArchitecture/03LambdaFunctions",permalink:"/my-notes/docs/AWS/Certificates/SolutionArchitecture/03LambdaFunctions",draft:!1,unlisted:!1,editUrl:"https://github.com/jishen027/my-notes/tree/main/docs/AWS/Certificates/SolutionArchitecture/03LambdaFunctions.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"02 Core AWS Storage Services",permalink:"/my-notes/docs/AWS/Certificates/SolutionArchitecture/02StorageService"},next:{title:"AWS Solution Architecture Associate Exam Prep",permalink:"/my-notes/docs/AWS/Certificates/SolutionArchitecture/ExamPrepAssociate"}},l={},a=[{value:"Introduce to Serverless",id:"introduce-to-serverless",level:2},{value:"How AWS Lambda works",id:"how-aws-lambda-works",level:2},{value:"Invocation models for running Lambda functions",id:"invocation-models-for-running-lambda-functions",level:3},{value:"Invocation model error behavior",id:"invocation-model-error-behavior",level:3},{value:"Lambda execution environment",id:"lambda-execution-environment",level:3},{value:"Performance optimizetion",id:"performance-optimizetion",level:3},{value:"AWS Lambda Function Permissions",id:"aws-lambda-function-permissions",level:2},{value:"Execution role",id:"execution-role",level:3},{value:"Resource-based policy",id:"resource-based-policy",level:3},{value:"Policy comparison",id:"policy-comparison",level:3},{value:"Accessing resources in a VPC",id:"accessing-resources-in-a-vpc",level:3},{value:"Authoring AWS Lambda functions",id:"authoring-aws-lambda-functions",level:2},{value:"Use your own code",id:"use-your-own-code",level:3},{value:"Building Lambda functions",id:"building-lambda-functions",level:3},{value:"What is SAM",id:"what-is-sam",level:3}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h1,{id:"03-aws-lambda-functions",children:"03 AWS Lambda Functions"}),"\n",(0,s.jsx)(e.h2,{id:"introduce-to-serverless",children:"Introduce to Serverless"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"AWS serverless platform"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"AWS serverless platform",src:i(3047).Z+"",width:"1037",height:"400"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"What is Lambda"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"run code without servers"}),"\n",(0,s.jsx)(e.li,{children:"initiates function for events"}),"\n",(0,s.jsx)(e.li,{children:"scale automatically"}),"\n",(0,s.jsxs)(e.li,{children:["provide monitoring and logging via ",(0,s.jsx)(e.code,{children:"Cloud Watch"})]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Event-driven architectures"})}),"\n",(0,s.jsx)(e.p,{children:"An event-driven architecture uses events to initiate actions and communication between decoupled services."}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Producers, routers, comsumers"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"prc",src:i(809).Z+"",width:"1159",height:"495"})}),"\n",(0,s.jsx)(e.h2,{id:"how-aws-lambda-works",children:"How AWS Lambda works"}),"\n",(0,s.jsx)(e.h3,{id:"invocation-models-for-running-lambda-functions",children:"Invocation models for running Lambda functions"}),"\n",(0,s.jsx)(e.p,{children:"Event sources can invoke a Lambda function in three general patterns."}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Synchronous invocation"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Synchronous events expect an immediate response from the function invocation."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"no build-in retries"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"Synchonous",src:i(931).Z+"",width:"381",height:"222"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Sychonours AWS Services"}),"\n",(0,s.jsx)(e.p,{children:"The following AWS services invoke Lambda synchronously:"}),"\n",(0,s.jsx)(e.p,{children:"Amazon API Gateway\nAmazon Cognito\nAWS CloudFormation\nAmazon Alexa\nAmazon Lex\nAmazon CloudFront"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Asynchronours invocation"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Async invocation"}),"\n",(0,s.jsx)(e.p,{children:"When you invoke a function asynchronously, events are queued and the requestor doesn't wait for the function to complete."}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"Async invocation",src:i(5292).Z+"",width:"635",height:"254"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Async AWS service integration"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Amazon SNS"}),"\n",(0,s.jsx)(e.li,{children:"Amazon S3"}),"\n",(0,s.jsx)(e.li,{children:"Amazon EventBridge"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Destinations"}),"\n",(0,s.jsx)(e.p,{children:"A destination can send records of asynchronous invocations to other services."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Polling invocation"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Polling"}),"\n",(0,s.jsx)(e.p,{children:"This invocation model is designed to integrate with AWS streaming and queuing based services with no code or server management. Lambda will poll (or watch) these services, retrieve any matching events, and invoke your functions"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Amazon Kinesis"}),"\n",(0,s.jsx)(e.li,{children:"Amazon SQS"}),"\n",(0,s.jsx)(e.li,{children:"Amazon DyanamoDB Strams"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Event Srouce Mapping"}),"\n",(0,s.jsx)(e.p,{children:"The configuration of services as event triggers is known as event source mapping. This process occurs when you configure event sources to launch your Lambda functions and then grant theses sources IAM permissions to access the Lambda function."}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Amazon DynamoDB"}),"\n",(0,s.jsx)(e.li,{children:"Amazon Kinesis"}),"\n",(0,s.jsx)(e.li,{children:"Amazon MQ"}),"\n",(0,s.jsx)(e.li,{children:"Amazon Managed Streaming for Apache Kafka"}),"\n",(0,s.jsx)(e.li,{children:"Self-managed Apache Kafka"}),"\n",(0,s.jsx)(e.li,{children:"Amazon SQS"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"invocation-model-error-behavior",children:"Invocation model error behavior"}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"Invocation Model"}),(0,s.jsx)(e.th,{children:"Error Behavior"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Synchronous"}),(0,s.jsx)(e.td,{children:"No retries"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Asynchronous"}),(0,s.jsx)(e.td,{children:"Built in \u2013 retries twice"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Polling"}),(0,s.jsx)(e.td,{children:"Depends on event source"})]})]})]}),"\n",(0,s.jsx)(e.h3,{id:"lambda-execution-environment",children:"Lambda execution environment"}),"\n",(0,s.jsx)(e.p,{children:"Lambda invokes your function in an execution environment, which is a secure and isolated environment."}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Execution environment lifecycle"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"lifecycle",src:i(7527).Z+"",width:"745",height:"163"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Init phase"}),"\n",(0,s.jsx)(e.p,{children:"In this phase, Lambda creates or unfreezes an execution environment with the configured resources, downloads the code for the function and all layers, initializes any extensions, initializes the runtime, and then runs the function\u2019s initialization code (the code outside the main handler)."}),"\n",(0,s.jsx)(e.p,{children:"Sub-phase:"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Extension init - starts all extensions"}),"\n",(0,s.jsx)(e.li,{children:"Runtime init - boostraps the runtime"}),"\n",(0,s.jsx)(e.li,{children:"Function init - run the function's static code"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Invoke pahse"}),"\n",(0,s.jsx)(e.p,{children:"In this phase, Lambda invokes the function handler."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Shutdown phase"}),"\n",(0,s.jsx)(e.p,{children:"If the Lambda function does not receive any invocations for a period of time, this phase initiates. In the Shutdown phase, Lambda shuts down the runtime, alerts the extensions to let them stop cleanly, and then removes the environment."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"performance-optimizetion",children:"Performance optimizetion"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Cold and warm starts"}),"\n",(0,s.jsx)(e.p,{children:"A cold start occurs when a new execution environment is required to run a Lambda function."}),"\n",(0,s.jsx)(e.p,{children:"In a warm start, the Lambda service retains the environment instead of destroying it immediately."}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"Cold and Warm start",src:i(7468).Z+"",width:"1118",height:"442"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Best practice: Minimize cold start times"}),"\n",(0,s.jsx)(e.p,{children:"For most applications, cold start is not a problem, however, for some synchronous models, thislatency can inhibit optimal performance."}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Optimize your function."}),"\n",(0,s.jsxs)(e.li,{children:["Use ",(0,s.jsx)(e.code,{children:"Provisioned concurrency"}),", it can prepare concurrent execution environment before invocations."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Best practice : Write functions to take advantage of warm starts"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Store and reference dependencies locally"}),"\n",(0,s.jsx)(e.li,{children:"Limit re-initialization of variables"}),"\n",(0,s.jsx)(e.li,{children:"Add code to check for and reuse existing connections"}),"\n",(0,s.jsx)(e.li,{children:"Use tmp space as transient cache"}),"\n",(0,s.jsx)(e.li,{children:"Check that background processes have completed."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"aws-lambda-function-permissions",children:"AWS Lambda Function Permissions"}),"\n",(0,s.jsx)(e.p,{children:"With Lambda functions, there are two sides that define the necessary scope of permissions \u2013 permission to invoke the function, and permission of the Lambda function itself to act upon other services."}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"Lambda Function Permissions",src:i(5048).Z+"",width:"516",height:"203"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"IAM Execution Roles",src:i(7095).Z+"",width:"1009",height:"453"})}),"\n",(0,s.jsx)(e.h3,{id:"execution-role",children:"Execution role"}),"\n",(0,s.jsx)(e.p,{children:"The execution role gives your function permissions to interact with other services."}),"\n",(0,s.jsx)(e.p,{children:"Example : Execution role definitions"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"IAM policy"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-json",children:'"Version": "2012-10-17",\n  "Statement" : [\n    {\n      "Sid": "Allow PutItem in table/test",\n      "Effect": "Allow",\n      "Action": "dynamodb:PutItem",\n      "Resource": "arn:aws:dynamodb:eu-west-2:###:table/test"\n    }\n  ]\n'})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Trust policy"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"A trust policy defines what actions your role can assume. The trust policy allows Lambda to use the role's permissions by giving the service principal lambda.amazonaws.com permission to call the AWS Security Token Service (AWS STS) AssumeRole action."}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-json",children:'{\n  "Effect": "Allow",\n  "Action": "sts:AssumeRole",\n  "Principal": {\n    "Service": "lambda.amazonaws.com"\n  }\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"resource-based-policy",children:"Resource-based policy"}),"\n",(0,s.jsx)(e.p,{children:"A resource policy (also called a function policy) tells the Lambda service which principals have permission to invoke the Lambda function. An AWS principal may be a user, role, another AWS service, or another AWS account."}),"\n",(0,s.jsx)(e.h3,{id:"policy-comparison",children:"Policy comparison"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Resource-based policy"}),"\n",(0,s.jsx)(e.p,{children:"Lambda resource-based policy"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:'Associated with a "push" event srouce such as Amazon API gateway'}),"\n",(0,s.jsx)(e.li,{children:"Created when you add a trigger to a Lambda function"}),"\n",(0,s.jsxs)(e.li,{children:["Allows the event source to take the lambda",":invokeFunction"," action"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Execution role"}),"\n",(0,s.jsx)(e.p,{children:"IAM execution role"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Role selected or created when you create a lambda function"}),"\n",(0,s.jsx)(e.li,{children:"IAM Policy includes actions you can take with the resource"}),"\n",(0,s.jsx)(e.li,{children:"Trust policy that allows Lambda to AssumeRole"}),"\n",(0,s.jsxs)(e.li,{children:["Creator must have permission for iam",":PassRole"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Example resource policy"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-json",children:'"Version" : "2012-10-17",\n"Id" : "test-policy",\n"Statement" : [\n  {\n    "Sid": "lambdaInvoke",\n    "Effect": "Allow",\n    "Principal": {\n      "Service": "s3.amazonaws.com"\n    },\n    "Action": "lambda:InvokeFunction",\n    "Resource": "arn:aws:lambda:eu-west-2:###:function:test",\n    "Condition": {\n      "ArnLike": {\n        "AWS:SourceArn": "arn:aws:s3:::test-bucket"\n      }\n    }\n  }\n]\n'})}),"\n",(0,s.jsx)(e.h3,{id:"accessing-resources-in-a-vpc",children:"Accessing resources in a VPC"}),"\n",(0,s.jsxs)(e.p,{children:["Enabling your Lambda function to access resources inside your virtual private cloud (VPC) requires additional VPC-specific configuration information, such as VPC ",(0,s.jsx)(e.code,{children:"subnet IDs"})," and ",(0,s.jsx)(e.code,{children:"security group IDs"}),"."]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Lambda and AWS PrivateLink"}),"\n",(0,s.jsx)(e.p,{children:"To establish a private connection between your VPC and Lambda, create an interface VPC endpoint."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"authoring-aws-lambda-functions",children:"Authoring AWS Lambda functions"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"learn best practice for writing Lambda function code."}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"use-your-own-code",children:"Use your own code"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Supported languages"}),"\n",(0,s.jsx)(e.p,{children:"Node.js, C#..."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Start with the handler method"}),"\n",(0,s.jsx)(e.p,{children:"The Lambda function handler is the method in your function code that processes events."}),"\n",(0,s.jsx)(e.p,{children:"The handler method takes two objects"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Event Ojbect"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"required"}),"\n",(0,s.jsxs)(e.li,{children:["when lambda invoked, ",(0,s.jsx)(e.code,{children:"event object"})," will be provide to handler"]}),"\n",(0,s.jsx)(e.li,{children:"event object is different"}),"\n",(0,s.jsx)(e.li,{children:"inlcude metadata your lambda function needs"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Context Object (optional)"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"allow you function code to interact with the lambda execution environment."}),"\n",(0,s.jsxs)(e.li,{children:["The content and structure based on language runtime, minimum element contains:","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.code,{children:"AWS RequestID"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.code,{children:"Runtime"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.code,{children:"Logging"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Design best practices"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Separate business logic"}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["Separate your core business logic from the handler event.\n",(0,s.jsx)(e.img,{alt:"separate business logic",src:i(3902).Z+"",width:"716",height:"316"})]}),"\n",(0,s.jsxs)(e.ol,{start:"2",children:["\n",(0,s.jsx)(e.li,{children:"Write modular functions"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"Module functions will reduce the amount of time that it takes for your deployment package to be downloaded and unpacked before invocation."}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"module functions",src:i(4798).Z+"",width:"629",height:"219"})}),"\n",(0,s.jsxs)(e.ol,{start:"3",children:["\n",(0,s.jsx)(e.li,{children:"Treat functions as stateless"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"No information about state should be saved within the context of the function itself."}),"\n",(0,s.jsx)(e.p,{children:"Consider one of the following options for storing state data:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"DynamoDB"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"ElasticCache"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"S3"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.ol,{start:"4",children:["\n",(0,s.jsx)(e.li,{children:"Only include what you need"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"Minimize both your deployment package dependencies and its size.\nThis can have a significant impact on the startup time for your function."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Best parctices for writing code"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Include logging statements"}),"\n",(0,s.jsx)(e.p,{children:"Lambda functions can and should include logging statements, which are written to CloudWatch."}),"\n",(0,s.jsx)(e.p,{children:"example"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import os\nimport logging\nlogger = logging,getLogger()\nlogger.setLevel(logging.INFO)\n\ndef lambda_handler(event, context):\n  logger.info('## ENVIRONMENT VARIABLES')\n  logger.info(os.environ)\n  logger.info(event)\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Use return coding"}),"\n",(0,s.jsx)(e.p,{children:"Functions must give Lambda information about the results of their actions."}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'exports.handler = async function (event, context) {\n  console.log("EVENT: \\n" + JSON.stringify(event, null, 2));\n  return context.logStreamName;\n};\n'})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Provide environment variables"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Take advantage of environment variables for operational parameters."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"You can use these parameters to pass updated configuration settings without changes to the code itself."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"You can also use environment variables to store sensitive information required by the function."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Add secret and refernce data"}),"\n",(0,s.jsx)(e.p,{children:"AWS Secrets Manager helps you organize and manage important configuration data such as credentials, passwords, and license keys."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Avoid recursive code"}),"\n",(0,s.jsx)(e.p,{children:"Avoid a situation in which a function calls itself."}),"\n",(0,s.jsx)(e.p,{children:"Recursive code could lead to uncontrolled scaling of invocations that would make you lose control of your concurrency."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["Gather metrics with Amazon ",(0,s.jsx)(e.code,{children:"CloudWatch"})]}),"\n",(0,s.jsx)(e.p,{children:"The CloudWatch embedded metric format (EMF) is a JSON specification used to instruct CloudWatch Logs to automatically extract metric values embedded in structured log events."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Reuse execution context"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Store dependencies locally."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Limit re-initialization of variables."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Reuse existing connections."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Use tmp space as transient cache."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Check that background processes have completed."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"building-lambda-functions",children:"Building Lambda functions"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Lambda console editor"}),"\n",(0,s.jsx)(e.p,{children:"You can author functions within the Lambda console, with an IDE toolkit, using command line tools, or using the AWS SDKs."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Deployment packages"}),"\n",(0,s.jsx)(e.p,{children:"Your Lambda function's code consists of scripts or compiled programs and their dependencies."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Automate using tools"}),"\n",(0,s.jsx)(e.p,{children:"Serverless applications built using Lambda are a combination of Lambda functions, event sources, and other resources defined using the AWS Serverless Application Model (AWS SAM)."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"what-is-sam",children:"What is SAM"}),"\n",(0,s.jsx)(e.p,{children:"AWS SAM is an open-source framework for building serverless applications. It provides shorthand syntax to express functions, APIs, databases, and event source mappings. With just a few lines per resource, you can define the application you want and model it using YAML. You provide AWS SAM with simplified instructions for your environment and during deployment AWS SAM transforms and expands the AWS SAM syntax into AWS CloudFormation syntax (a fully detailed CloudFormation template)."}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"sam",src:i(5110).Z+"",width:"704",height:"435"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"SAM prebuild policies\nAWS SAM provides a number of predefined, commonly used templates that you can use to build for least privilege security access."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"SAM CLI can test and deploy the lambda function"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Invoke functions and run automated tests locally."}),"\n",(0,s.jsx)(e.li,{children:"Generate sample event srouce payloads."}),"\n",(0,s.jsx)(e.li,{children:"Run api gateway locally."}),"\n",(0,s.jsx)(e.li,{children:"Debug code."}),"\n",(0,s.jsx)(e.li,{children:"Review Lambda function logs."}),"\n",(0,s.jsx)(e.li,{children:"Validate AWS SAM templates."}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"SAM CLI",src:i(6562).Z+"",width:"566",height:"385"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"AWS SAM CLI"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"init"}),"\n",(0,s.jsx)(e.p,{children:"Initializes a serverless application."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"local\nRuns application locally"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"validate"}),"\n",(0,s.jsx)(e.p,{children:"Validates an AWS SAM template."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"deploy"}),"\n",(0,s.jsx)(e.p,{children:"Deploys an sam application"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"build"}),"\n",(0,s.jsx)(e.p,{children:"Builds a serverless application and prepares it for subsequent steps in your workflow."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Serverless CI/CD pipeline"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"CodeBuild - Automate the process of packaging code and run tests"}),"\n",(0,s.jsx)(e.li,{children:"CodeDeploy - Use Version management options to ensure safe deployments."}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"CI/CD Serverless",src:i(506).Z+"",width:"659",height:"393"})}),"\n"]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,t.a)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},3047:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-18-83e2af9ae0ee78dec831fb5bff622887.png"},809:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-19-9098abde93c9bbf163819189c09ddd76.png"},931:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-20-7b401b41a396457d2ab48401cd2c25fa.png"},5292:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-21-b6ba1302f5e6e005f5fba27d54c2caae.png"},7527:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-22-b23bb3d0d02b3f8832bca059ece39253.png"},7468:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-23-c277ead44e0218bb27cc22671768782c.png"},5048:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-24-445360782cc166092b53c0f9380b5e31.png"},7095:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-25-11ee73d774e507dc45f7d1b17568ef2d.png"},3902:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-26-f1cefa3531bc8a999416fc5aede8b32f.png"},4798:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-27-ba81d6522b3211323279b265a4d2d3cd.png"},5110:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-28-c7c4f717c26859a9d8c90c446a17e088.png"},6562:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-29-1c68584eaae508562d6a45b25aa480fa.png"},506:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-30-5ff706cb292b9e0244006b18ee11129d.png"},1151:(n,e,i)=>{i.d(e,{Z:()=>c,a:()=>o});var s=i(7294);const t={},r=s.createContext(t);function o(n){const e=s.useContext(r);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:o(n.components),s.createElement(r.Provider,{value:e},n.children)}}}]);