"use strict";(self.webpackChunkmd_note=self.webpackChunkmd_note||[]).push([[1573],{9677:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});var a=t(5893),s=t(1151);const o={},l="How to setup a scheduler in Laravel",r={id:"Laravel/Scheduler",title:"How to setup a scheduler in Laravel",description:"context",source:"@site/docs/Laravel/Scheduler.md",sourceDirName:"Laravel",slug:"/Laravel/Scheduler",permalink:"/my-notes/docs/Laravel/Scheduler",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Laravel/Scheduler.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Laravel Broadcasting using pusher",permalink:"/my-notes/docs/Laravel/Pusher"},next:{title:"NextAuth",permalink:"/my-notes/docs/NextJs/NextAuth"}},c={},d=[{value:"context",id:"context",level:3}];function i(e){const n={code:"code",h1:"h1",h3:"h3",li:"li",ol:"ol",pre:"pre",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"how-to-setup-a-scheduler-in-laravel",children:"How to setup a scheduler in Laravel"}),"\n",(0,a.jsx)(n.h3,{id:"context",children:"context"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Laravel 9.0\n\nThe Consultation can be scheduled with a start and end date.\n\nwhen the consultation is scheduled, the consultation is added to the scheduler.\n\nwhen start date is reached, the scheduler sends an email to the user.\n\nwhen end date is reached, the scheduler sends an email to the user.\n\n"})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Create a new command"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"php artisan make:command SendEmails\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"2",children:["\n",(0,a.jsx)(n.li,{children:"Add the command to the schedule method in the app/Console/Kernel.php file"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",children:"protected function schedule(Schedule $schedule)\n{\n    $schedule->command('emails:send')->daily();\n}\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"3",children:["\n",(0,a.jsx)(n.li,{children:"Add the command to the app/Console/Commands/SendEmails.php file"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",children:"public function handle()\n{\n    // get all consultations that are scheduled for today\n    $consultations = Consultation::whereDate('start_date', Carbon::today())->get();\n\n    // send email to each user\n    foreach ($consultations as $consultation) {\n        Mail::to($consultation->user)->send(new ConsultationStart($consultation));\n    }\n\n    // get all consultations that are scheduled for today\n    $consultations = Consultation::whereDate('end_date', Carbon::today())->get();\n\n    // send email to each user\n    foreach ($consultations as $consultation) {\n        Mail::to($consultation->user)->send(new ConsultationEnd($consultation));\n    }\n}\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"4",children:["\n",(0,a.jsx)(n.li,{children:"start the scheduler"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"php artisan schedule:work\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"5",children:["\n",(0,a.jsx)(n.li,{children:"add the scheduler to the cronjob"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"* * * * * cd /path-to-your-project && php artisan schedule:run >> /dev/null 2>&1\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(i,{...e})}):i(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>r,a:()=>l});var a=t(7294);const s={},o=a.createContext(s);function l(e){const n=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);