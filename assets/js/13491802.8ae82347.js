"use strict";(self.webpackChunkmd_note=self.webpackChunkmd_note||[]).push([[3035],{6646:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>a,toc:()=>p});var s=t(5893),r=t(1151);const i={},o=void 0,a={id:"Azure/Pipeline/Pipeline_Siteground",title:"Pipeline_Siteground",description:"Use Azure Pipeline to Deploy Vite Vue App to Siteground",source:"@site/docs/Azure/Pipeline/Pipeline_Siteground.md",sourceDirName:"Azure/Pipeline",slug:"/Azure/Pipeline/Pipeline_Siteground",permalink:"/my-notes/docs/Azure/Pipeline/Pipeline_Siteground",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Azure/Pipeline/Pipeline_Siteground.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Pipeline_Digital_Ocean",permalink:"/my-notes/docs/Azure/Pipeline/Pipeline_Digital_Ocean"},next:{title:"Prompt_design",permalink:"/my-notes/docs/ChatGPT/Prompt_design"}},l={},p=[{value:"Use Azure Pipeline to Deploy Vite Vue App to Siteground",id:"use-azure-pipeline-to-deploy-vite-vue-app-to-siteground",level:2},{value:"Create Siteground SSH Key",id:"create-siteground-ssh-key",level:3},{value:"Create Azure Pipeline",id:"create-azure-pipeline",level:3}];function u(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",pre:"pre",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"use-azure-pipeline-to-deploy-vite-vue-app-to-siteground",children:"Use Azure Pipeline to Deploy Vite Vue App to Siteground"}),"\n",(0,s.jsx)(n.h3,{id:"create-siteground-ssh-key",children:"Create Siteground SSH Key"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Login to Siteground"}),"\n",(0,s.jsx)(n.li,{children:"Go to Devs > SSH Keys Manager"}),"\n",(0,s.jsx)(n.li,{children:"Click Generate New Key"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"create-azure-pipeline",children:"Create Azure Pipeline"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Login to Azure DevOps"}),"\n",(0,s.jsx)(n.li,{children:"Create Azure_Pipeline.yml file for the project"}),"\n",(0,s.jsx)(n.li,{children:"Add the following code to the file"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Node.js with Vue\n# Build a Node.js project that uses Vue.\n# Add steps that analyze code, save build artifacts, deploy, and more:\n# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript\n\ntrigger:\n- master\n\npool:\n  vmImage: ubuntu-latest\n\n# Variables\nvariables:\n- group: 'sshKeyPassphrase'  # Link the variable group\n- name: 'frontendDir'\n  value: 'frontend'\n- name: 'backendDir'\n  value: 'backend'\n- name: 'remoteServer'\n  value: 'ssh.the360expo.com'\n- name: 'remoteUser'\n  value: 'u413-vckbx5xu4xp8'\n- name: 'remotePath'\n  value: '/home/u413-vckbx5xu4xp8/www/virtualconsultation.the360expo.com/public_html'\n- name: 'remoteServerPath'\n  value: '/home/u413-vckbx5xu4xp8/www/virtualconsultation.the360expo.com/vpc_server'\n- name: 'sshKeySecureFileName'\n  value: 'vpc-corn-job-pri.pub'\n\n# Install Node.js\nsteps:\n- task: NodeTool@0\n  inputs:\n    versionSpec: '14.x'\n  displayName: 'Install Node.js'\n\n# Download SSH Key\n- task: DownloadSecureFile@1\n  name: sshKey\n  displayName: 'Download SSH Key'\n  inputs:\n    secureFile: 'vpc-corn-job-pri.pub'  # Make sure this is the private key\n\n# Install and Build Frontend\n- script: |\n    cd $(frontendDir)\n    cp .env.prod .env\n    npm install\n    npm run build\n  displayName: 'npm install and build'\n\n# SCP Frontend dist folder to Remote Server\n- script: |\n   echo \"Secure File Path: $(sshKey.secureFilePath)\"\n   chmod 600 $(sshKey.secureFilePath)  # Fix permissions\n   eval $(ssh-agent -s)  # Start the SSH agent\n   mkdir -p ~/.ssh  # Ensure the .ssh directory exists\n   touch ~/.ssh/known_hosts  # Ensure the known_hosts file exists\n   ssh-keyscan -p 18765 $(remoteServer) >> ~/.ssh/known_hosts  # Add the remote server to the known hosts file\n   echo \"$(corn_ssh_key_passphrase)\" | ssh-add $(sshKey.secureFilePath)  # Add the SSH key to the agent\n   sshpass -p \"$(corn_ssh_key_passphrase)\" scp -P 18765 -r $(frontendDir)/dist/* $(remoteUser)@$(remoteServer):$(remotePath)  # Use sshpass to pass the passphrase and perform the SCP operation\n  displayName: 'SCP Frontend dist folder to Remote Server'\n  env: \n    corn_ssh_key_passphrase: $(corn_ssh_key_passphrase)  # Passphrase for the SSH key\n\n"})})]})}function d(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>o});var s=t(7294);const r={},i=s.createContext(r);function o(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);